apiVersion: voyager.appscode.com/v1beta1
kind: Ingress
metadata:
  name: ingress
  annotations:
    ingress.appscode.com/type: LoadBalancer
spec:
  tls:
  - secretName: default-cert
    hosts:
    {{- range .Values.servers }}
      - {{ .host }}
    {{- end }} 
  rules:
{{- range .Values.servers }}
  - host: {{ .host }}
    http:
      port: 443
      paths:
        - backend:
            serviceName: fwserver-svc-{{ .name }}
            servicePort: fw-web
  - host: {{ .host }}
    http:
      port: 20443
      paths:
        - backend:
            serviceName: fwserver-svc-{{ .name }}
            servicePort: mdm
  - host: {{ .host }}
    http:
      port: 20445
      paths:
        - backend:
            serviceName: fwserver-svc-{{ .name }}
            servicePort: django
  - host: {{ .host }}
    http:
      port: 20446
      paths:
        - backend:
            serviceName: fwserver-svc-{{ .name }}
            servicePort: noidea
  - host: {{ .host }}
    tcp:
      port: {{ .port_prefix }}2
      noTLS: true
      backend:
        serviceName: fwserver-svc-{{ .name }}
        servicePort: port20005
  - host: {{ .host }}
    tcp:
      port: {{ .port_prefix }}3
      noTLS: true
      backend:
        serviceName: fwserver-svc-{{ .name }}
        servicePort: port2006
  - host: {{ .host }}
    tcp:
      port: {{ .port_prefix }}4
      backend:
        serviceName: fwserver-svc-{{ .name }}
        servicePort: fwxserver-a
  - host: {{ .host }}
    tcp:
      port: {{ .port_prefix }}5
      backend:
        serviceName: fwserver-svc-{{ .name }}
        servicePort: fwserver-ssl
  - host: {{ .host }}
    tcp:
      port: {{ .port_prefix }}1
      backend:
        serviceName: fwserver-svc-{{ .name }}
        servicePort: booster
  
{{- end }}
